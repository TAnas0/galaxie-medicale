---
import Card from "../ui/Card.astro";
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

let products = await getCollection('products');
products = [...products, ...products, ...products]
---

<div
  class="grid md:grid-cols-3 ltablet:grid-cols-3 lg:grid-cols-3 gap-x-4 ptablet:gap-x-4 gap-y-6 pt-1 mr-2 ml-2 md:ml-0 md:mr-0"
>
  {
    products.map((product) => (
      <div
        x-show={`activeCategory === 'all' || activeCategory === '${product.data.category}'`}
        class="h-full"
      >
        <a href={`/galaxie-medicale/products/${product.id}`} class="block h-full group transition-all duration-300 hover:scale-[1.015]">
  <Card class="h-full flex flex-col rounded-xl border border-muted-200 dark:border-muted-700 bg-white dark:bg-muted-900 shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden">
    
    <!-- Product Image -->
    <div class="relative w-full aspect-[4/3] bg-muted-100 dark:bg-muted-800">
      <Image
        src={product.data.image2}
        alt={product.data.name}
        class="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105"
      />
    </div>

    <!-- Product Info -->
    <div class="flex flex-col p-3 gap-1 mt-auto">
      <h4 class="text-base font-semibold text-muted-800 dark:text-muted-100 truncate">
        {product.data.name}
      </h4>
      <p class="text-sm text-muted-500 dark:text-muted-400 truncate">
        {product.data.category}
      </p>
      <p class="text-sm text-muted-500 dark:text-muted-400 truncate">
        {product.data.brand.name}
      </p>
    </div>
  </Card>
</a>

      </div>
    ))
  }
</div>
